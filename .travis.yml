sudo: required

language: python

python:
  - "3.6"

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install sshpass -qq -y

services:
  - docker

script:
  - docker build -t="instantbox/instantbox:pre_build" -f ./Dockerfile .
  - docker run -d -P --name="inspire" instantbox/instantbox:pre_build
  - docker rm -f inspire || true

notifications:
  email: true
  
after_success:
  - if [[ "$TRAVIS_BRANCH" == "master" ]]; then 
      docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD";
      docker tag instantbox/instantbox:pre_build instantbox/instantbox;
      docker push instantbox/instantbox;
    fi

